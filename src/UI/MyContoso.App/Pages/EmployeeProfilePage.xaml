<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:fs="clr-namespace:FlagstoneUI.Core.Controls;assembly=FlagstoneUI.Core"
             xmlns:vm="clr-namespace:MyContoso.App.ViewModels"
             xmlns:mct="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:li="clr-namespace:Plugin.Maui.Lucide;assembly=Plugin.Maui.Lucide"
             xmlns:lucide="clr-namespace:Plugin.Maui.Lucide.Controls;assembly=Plugin.Maui.Lucide"
             x:Class="MyContoso.App.Pages.EmployeeProfilePage"
             x:DataType="vm:EmployeeProfileViewModel"
             Title="Employee Profile">
    <ContentPage.Resources>
        <mct:InvertedBoolConverter x:Key="InverseBool" />
    </ContentPage.Resources>
    <ScrollView>
        <VerticalStackLayout>
            <ActivityIndicator IsRunning="{Binding IsLoading}"
                             IsVisible="{Binding IsLoading}"
                             Color="{DynamicResource Color.Primary}"
                             HorizontalOptions="Center" />
            
            <VerticalStackLayout IsVisible="{Binding Employee, Converter={StaticResource IsNotNullConverter}}">
                
                <fs:FsCard Style="{DynamicResource ElevatedCard}"
                           Elevation="1">
                    <FlexLayout Direction="Column"
                                AlignItems="Center"
                                JustifyContent="SpaceBetween"
                                VerticalOptions="Fill"
                                MinimumHeightRequest="350">
                        
                        <mct:AvatarView Text="{Binding Employee.Name, Converter={StaticResource InitialsConverter}}"
                                        ImageSource="{Binding Employee.AvatarUrl}"
                                        BorderColor="{DynamicResource Color.Secondary}"
                                        BorderWidth="3"
                                        WidthRequest="100"
                                        CornerRadius="50"
                                        HeightRequest="100"
                                        Margin="0,0,10,0"/>
                        
                        <VerticalStackLayout Margin="0,0,10,0">
                            <Label Text="{Binding Employee.Name}"
                                   TextColor="{DynamicResource Color.OnSurface}"
                                   HorizontalOptions="Center"
                                   HorizontalTextAlignment="Center"
                                   FontSize="{DynamicResource FontSize.TitleMedium}"
                                   FontAttributes="Bold"
                                   FontFamily="{OnPlatform iOS='OpenSansBold'}"/>
                            
                            <Label Text="{Binding Employee.Role}"
                                   TextColor="{DynamicResource Color.OnSurfaceVariant}"
                                   HorizontalOptions="Center"
                                   HorizontalTextAlignment="Center"/>
                        </VerticalStackLayout>
                        
                        <!-- Department Badge -->
                        <Border Padding="8,2"
                                Margin="0,0,10,0"
                                MaximumHeightRequest="24"
                                StrokeShape="RoundRectangle 12"
                                VerticalOptions="Start"
                                HorizontalOptions="End"
                                BackgroundColor="{DynamicResource Color.Secondary}"
                                StrokeThickness="0">
                            <Label Text="{Binding Employee.Department}"
                                   TextColor="{DynamicResource Color.OnSecondary}"
                                   HorizontalOptions="Center" />
                        </Border>
                        
                        <Grid ColumnDefinitions="*,*"
                              ColumnSpacing="10"
                              Margin="0,0,10,0"
                              MinimumHeightRequest="30"
                              IsVisible="{Binding IsMyProfile, Converter={StaticResource InverseBool}}"
                              WidthRequest="300">
                            <fs:FsButton HorizontalOptions="Fill"
                                         BackgroundColor="{DynamicResource Color.Primary}"
                                         CornerRadius="12"
                                         TextColor="White"
                                         ImageSource="{FontImageSource FontFamily='lucide', Glyph={DynamicResource MessageCircle}, Size=14}"
                                         ContentLayout="Left"
                                         MaximumHeightRequest="35"
                                         Text="Message"/>
                            
                            <fs:FsButton Grid.Column="1"
                                         HorizontalOptions="Fill"
                                         Style="{DynamicResource OutlinedButton}"
                                         CornerRadius="12"
                                         TextColor="{DynamicResource Gray900}"
                                         ImageSource="{FontImageSource FontFamily='lucide', Glyph={DynamicResource Mail}, Color={DynamicResource Gray900}}"
                                         ContentLayout="Left"
                                         MaximumHeightRequest="35"
                                         Text="Email"/>
                        </Grid>
                        
                        <fs:FsButton HorizontalOptions="Fill"
                                     BackgroundColor="{DynamicResource Color.Primary}"
                                     CornerRadius="12"
                                     TextColor="White"
                                     ImageSource="{FontImageSource FontFamily='lucide', Glyph={DynamicResource SquarePen}, Size=14}"
                                     ContentLayout="Left"
                                     MaximumHeightRequest="30"
                                     WidthRequest="200"
                                     Margin="0,5,10,0"
                                     Text="Edit Profile"
                                     IsVisible="{Binding IsMyProfile}"/>
                        
                        <BoxView HorizontalOptions="Fill"
                                 HeightRequest="1"
                                 WidthRequest="300"
                                 Margin="0,0,10,0"
                                 Opacity="0.5"
                                 BackgroundColor="{DynamicResource Gray300}"/>
                        
                        <Label WidthRequest="300"
                               Text="{Binding Employee.ProfileSummary}"
                               FontSize="Small"
                               TextColor="{StaticResource Gray600}"/>
                    </FlexLayout>
                </fs:FsCard>
                
                <fs:FsCard Style="{DynamicResource ElevatedCard}"
                           Elevation="1">
                    <VerticalStackLayout Spacing="20"
                                         Padding="10">
                        <Label Text="Contact Information"
                               TextColor="{DynamicResource Color.OnSurface}"
                               FontSize="{DynamicResource FontSize.TitleMedium}"
                               FontAttributes="Bold" />
                    
                        <Grid RowDefinitions="*,*,*,*"
                              ColumnDefinitions="40,*"
                              ColumnSpacing="15"
                              RowSpacing="20">
                            <!-- Email -->
                            <Border Grid.Column="0"
                                    Grid.Row="0"
                                    StrokeShape="RoundRectangle 12"
                                    MaximumHeightRequest="40"
                                    StrokeThickness="0"
                                    BackgroundColor="{DynamicResource Color.Primary.10Pc}">
                                <lucide:Icon Name="{DynamicResource Mail}"
                                             Color="{DynamicResource Color.Primary}" />
                            </Border>
                            
                            <VerticalStackLayout Grid.Column="1"
                                                 Grid.Row="0">
                                <Label TextColor="{StaticResource Gray600}"
                                       FontSize="Small"
                                       Text="Email" />
                                
                                <Label TextColor="{StaticResource Gray900}"
                                       Text="{Binding Employee.ContactInfo.Email}" />
                            </VerticalStackLayout>
                            
                            <!-- Phone -->
                            <Border Grid.Column="0"
                                    Grid.Row="1"
                                    StrokeShape="RoundRectangle 12"
                                    MaximumHeightRequest="40"
                                    StrokeThickness="0"
                                    BackgroundColor="{DynamicResource Color.Secondary.10Pc}">
                                <lucide:Icon Name="{DynamicResource Phone}"
                                             Color="{DynamicResource Color.Secondary}" />
                            </Border>
                            
                            <VerticalStackLayout Grid.Column="1"
                                                 Grid.Row="1">
                                <Label TextColor="{StaticResource Gray600}"
                                       FontSize="Small"
                                       Text="Phone" />
                                
                                <Label TextColor="{StaticResource Gray900}"
                                       Text="{Binding Employee.ContactInfo.Phone}" />
                            </VerticalStackLayout>
                            
                            <!-- Address -->
                            <Border Grid.Column="0"
                                    Grid.Row="2"
                                    StrokeShape="RoundRectangle 12"
                                    MaximumHeightRequest="40"
                                    StrokeThickness="0"
                                    BackgroundColor="{DynamicResource Color.Secondary.10Pc}"
                                    IsVisible="{Binding IsMyProfile}">
                                <lucide:Icon Name="{x:Static li:Icons.MapPin}"
                                             Color="{DynamicResource Color.Secondary}" />
                            </Border>
                            
                            <VerticalStackLayout Grid.Column="1"
                                                 Grid.Row="2"
                                                 IsVisible="{Binding IsMyProfile}">
                                <Label TextColor="{StaticResource Gray600}"
                                       FontSize="Small"
                                       Text="Address" />
                                
                                <Label TextColor="{StaticResource Gray900}"
                                       Text="{Binding Employee.ContactInfo.Address}" />
                            </VerticalStackLayout>
                            
                            <!-- Date of birth -->
                            <Border Grid.Column="0"
                                    Grid.Row="3"
                                    StrokeShape="RoundRectangle 12"
                                    MaximumHeightRequest="40"
                                    StrokeThickness="0"
                                    BackgroundColor="{DynamicResource Color.Primary.10Pc}"
                                    IsVisible="{Binding IsMyProfile}">
                                <lucide:Icon Name="{DynamicResource Calendar}"
                                             Color="{DynamicResource Color.Primary}" />
                            </Border>
                            
                            <VerticalStackLayout Grid.Column="1"
                                                 Grid.Row="3"
                                                 IsVisible="{Binding IsMyProfile}">
                                <Label TextColor="{StaticResource Gray600}"
                                       FontSize="Small"
                                       Text="Date of Birth" />
                                
                                <Label TextColor="{StaticResource Gray900}"
                                       Text="{Binding Employee.ContactInfo.DateOfBirth, StringFormat='{0:dd MMM yyyy}'}" />
                            </VerticalStackLayout>
                            
                        </Grid>
                    </VerticalStackLayout>
                </fs:FsCard>
                
                <fs:FsCard Style="{DynamicResource ElevatedCard}"
                           Elevation="1">
                    <VerticalStackLayout Spacing="{DynamicResource Space.12}"
                                         Padding="10,20">
                        <FlexLayout Direction="Row"
                                    JustifyContent="SpaceBetween">
                            <HorizontalStackLayout Spacing="5">
                                <lucide:Icon Name="{DynamicResource Award}"
                                             Color="{DynamicResource Color.Primary}" />
                                <Label Text="Accreditations"
                                       TextColor="{DynamicResource Color.OnSurface}"
                                       FontSize="{DynamicResource FontSize.TitleMedium}"
                                       FontAttributes="Bold"
                                       FontFamily="{OnPlatform iOS='OpenSansBold'}"/>
                            </HorizontalStackLayout>
                            <Label Text="View All"/>
                        </FlexLayout>
                        <HorizontalStackLayout Spacing="{DynamicResource Space.8}">
                            <Label Text="{Binding ActiveAccreditations, StringFormat='{0} Active,'}"
                                   TextColor="{StaticResource Gray600}"
                                   VerticalOptions="Center" />
                            <Label Text="{Binding ExpiringAccreditations, StringFormat='{0} expiring soon'}"
                                   TextColor="{StaticResource Gray600}"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </fs:FsCard>
            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
